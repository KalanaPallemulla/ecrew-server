let express,formidable,Addver,fs;_7b4‍.w("express",[["default",["express"],function(v){express=v}]]);_7b4‍.w("express-formidable",[["default",["formidable"],function(v){formidable=v}]]);_7b4‍.w("../models/Addver",[["default",["Addver"],function(v){Addver=v}]]);_7b4‍.w("fs",[["default",["fs"],function(v){fs=v}]]);




const router = express.Router();

router.post("/add/:id", formidable(), async (req, res) => {
  const files = req.files;
  _7b4‍.g.console.log(files);

  if (req.params.id) {
    let add = await Addver.findById(req.params.id);

    if (add) {
      await Addver.findByIdAndUpdate(req.params.id, files, {
        new: true,
      }).exec();
      res.send({ msg: "updated" });
    }
  } else {
    let add = new Addver();

    if (files.image) {
      add.image.data = fs.readFileSync(files.image.path);
      add.image.contentType = files.image.type;
    }

    add.save((err, result) => {
      if (err) {
        _7b4‍.g.console.log("Image Add =>", err);
        res.status(400).json(err);
      }
      res.send(result);
    });
  }
});

module.exports = router;
